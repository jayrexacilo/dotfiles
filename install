#!/bin/bash

curr_dir=$(pwd)

# install packages

function install_pac {
  i=0
  for pac in base-devel pulseaudio pulseaudio-alsa xorg xorg-server xorg-xinit xdg-utils i3-wm dmenu rofi sudo i3blocks alacritty xterm lxappearance firefox noto-fonts-emoji flameshot acpi wget bc nitrogen i3lock imagemagick picom xorg-xprop
  do
   pacman --noconfirm --needed -S $pac > /dev/null
   echo XXX
   i=$((i + 6))
   echo $i
   echo "Installing... $pac"
   echo XXX
  done | whiptail --gauge "Installing..." 6 50 0
}

function reconfig_files {
  #remove config files
  rm -fr ~/.bg-wallpapers
  rm -fr ~/.config
  rm -fr ~/.local
  rm -fr ~/.vim
  rm -fr ~/.themes
  rm -f ~/.bash_profile
  rm -f ~/.bashrc
  rm -f ~/.vimrc
  rm -f ~/.xinitrc

  #copy all configs
  cp -fr $curr_dir/.bg-wallpapers ~/.bg-wallpapers
  cp -frs $curr_dir/.config ~/.config
  cp -frs $curr_dir/.local ~/.local
  cp -frs $curr_dir/.vim ~/.vim
  cp -frs $curr_dir/.themes ~/.themes
  cp -fs $curr_dir/.bash_profile ~/.bash_profile
  cp -fs $curr_dir/.bashrc ~/.bashrc
  cp -fs $curr_dir/.vimrc ~/.vimrc
  cp -fs $curr_dir/.xinitrc ~/.xinitrc

  mkdir ~/.local/share
}

whiptail --title "What to do?" --checklist --separate-output "Please select" 10 65 3 "INSTALL_PACKAGES" "It will install default packages" ON "RECONFIGURE_FILES" "Set the default configs" OFF 2>results

while read choice
do
  case $choice in
    INSTALL_PACKAGES) install_pac
    ;;
    RECONFIGURE_FILES) reconfig_files
    ;;
    *)
    ;;
  esac
done < results
